{
  "url": "https://habr.com/ru/articles/843488/comments/",
  "article_id": 843488,
  "title": "Как я научил бухгалтерию составлять договора дарения со скоростью 1 договор в 4 секунды",
  "comments": [
    {
      "id": 27357272,
      "author": "economist75",
      "datetime": "2024-09-30T05:22:00.000Z",
      "text": "Скорость слияния в свободном и бесплатном OpenOffice|LibreOffice на похожих документах достигает 0,03 сек/договор. При этом не требуется программирования вовсе, суммы и даты прописью - из коробки, Стили, форматирование - готовые, из других, уже имеющихся документов, и абсолютно всё работает локально. На выбор - формирование одного или тысяч файлов россыпью, в любом из 20-ти популярных форматов, включая PDF c элементами формы (списки, флажки) для ручного дозаполнения.Для соблюдения Закона о ПД можно просто создать криптоконтейнер VeraCrypt в котором без установки распаковать весь Portable LibreOffice (не требует установки и прав админа) и не светить паспортными данными вообще нигде. После отмонтирования контейнера на ПК не будет никаких следов ПД, кроме выходных PDF/DOCX/ODT-файлов (вот с ними - да, надо быть аккуратнее).Единственное, в чем может потребоваться помощь айтишника - это подсказать что 1С (все ПД лежат там) злонамеренно ограничивает число кодировок при экспорте таблиц (Сохранить как) и что cp1251 (Win) легко заменяется на utf-8 (Unicode) в LibreOffice.Конечно же, айтишнику есть что улучшить даже в этой схеме. Например, готовый \"слиянием\" PDF может содержать не только элементы управления, но и код, который будет его обрабатывать. Это или JavaScript (мехнизм PDF), или StarBasic/Python/Java/JavaScript, внедренный внутрь PDF по установке галочки \"гибридный\" PDF. По сути вы получаете PDF-контейнер, в котором находится \"заряженный\" макросами ODT (OpenDocumentFormat), и он может бесконечно перезаполняться слиянием многократно (при открытии в OpenOffice|LibreOffice), но останется \"обычным\" PDF для всех остальных, кому это не нужно. Ничего подобного ни один платный \"офис\" и другие свободные пакеты пока не умеют и еще очень долго не смогут."
    },
    {
      "id": 27356942,
      "author": "Wesha",
      "datetime": "2024-09-30T01:49:14.000Z",
      "text": "copyDocBody.replaceText('ФИО', fullName);         copyDocBody.replaceText('Должность', position);         copyDocBody.replaceText('Сумма', formattedAmount);...А потом приходит к бухгалтерам заключать ентот самый договор некийнекий Ахматиз одной маленькой, но очень южной республики — и аффтар такой \"Ё-моё, что ж я сделал?\""
    },
    {
      "id": 27356948,
      "author": "empenoso",
      "datetime": "2024-09-30T01:57:23.000Z",
      "text": "Немного не понял о чём вопрос.В данном конкретном примере не больше сотни договоров за раз было."
    },
    {
      "id": 27356986,
      "author": "Wesha",
      "datetime": "2024-09-30T02:12:49.000Z",
      "text": "Подумайте головой, что будет, если в тексте документасначалазаменить все включенияподстроки\"ФИО\" на \"Ахмат Имярекович Суммаев\", апотомвсе включенияподстроки\"Сумма\" на, скажем, \"10000 руб\"..."
    },
    {
      "id": 27357024,
      "author": "empenoso",
      "datetime": "2024-09-30T03:18:52.000Z",
      "text": "А вы про это. Ну да.Можно заменить эти имена на другие хотя бы на английском например"
    },
    {
      "id": 27357022,
      "author": "tekerrr",
      "datetime": "2024-09-30T03:18:00.000Z",
      "text": "ФИО ... CуммаАхмат Суммаев ... СуммаАхмат 0ев ... 0"
    },
    {
      "id": 27359968,
      "author": "Wesha",
      "datetime": "2024-09-30T15:35:16.000Z",
      "text": "Вот этим джуны и отличаются от синьоров, что я такие багисразувижу при беглом взгляде на код — а онине понимают, пока им консилиум из нескольких человек не объяснит.Помнится, в одной из серий Bonkers был диалог:— Но, шеф, я не думаю...(перебивая):— Вот этим я от вас и отличаюсь!"
    },
    {
      "id": 27357002,
      "author": "REPISOT",
      "datetime": "2024-09-30T02:52:17.000Z",
      "text": "Как я научил бухгалтерию составлять договора дарения со скоростью 1 договор в 4 секундыА они вас в ответ научили говоритьдоговоравместодоговоры?"
    },
    {
      "id": 27357064,
      "author": "MAXH0",
      "datetime": "2024-09-30T03:53:56.000Z",
      "text": "Что меня в этом умиляет - это бухгалтерия отправляющая в Гугл персональные данные сотрудников без всякого шифрования."
    },
    {
      "id": 27357184,
      "author": "empenoso",
      "datetime": "2024-09-30T05:04:43.000Z",
      "text": "Корпоративный аккаунт"
    },
    {
      "id": 27357274,
      "author": "Surrogate",
      "datetime": "2024-09-30T05:22:56.000Z",
      "text": "Корпоративные аккаунты Google ещё работают в России в 2024 году?"
    },
    {
      "id": 27357246,
      "author": "Surrogate",
      "datetime": "2024-09-30T05:10:52.000Z",
      "text": "@empenoso, статья очень интересная!Но мне кажется вы заново изобрели, то что в MS Word называется поля слияния (mail merge)? Аналоги есть вLibreOfficeи вR7-office. Возможно есть и в других импортозаместительных продуктах.На мой взгляд, для бухгалтерии ваш способ сложноват! В нашей конторе, точно бы не осилили..."
    },
    {
      "id": 27370690,
      "author": "DMGarikk",
      "datetime": "2024-10-03T06:15:08.000Z",
      "text": "Вы ещё не видели бухгалтеров которые на флешке всю базу отдают приходящему васяну программисту которого на авито нагуглили? Каждый второй так делает"
    },
    {
      "id": 27357272,
      "author": "economist75",
      "datetime": "2024-09-30T05:22:00.000Z",
      "text": "Скорость слияния в свободном и бесплатном OpenOffice|LibreOffice на похожих документах достигает 0,03 сек/договор. При этом не требуется программирования вовсе, суммы и даты прописью - из коробки, Стили, форматирование - готовые, из других, уже имеющихся документов, и абсолютно всё работает локально. На выбор - формирование одного или тысяч файлов россыпью, в любом из 20-ти популярных форматов, включая PDF c элементами формы (списки, флажки) для ручного дозаполнения.Для соблюдения Закона о ПД можно просто создать криптоконтейнер VeraCrypt в котором без установки распаковать весь Portable LibreOffice (не требует установки и прав админа) и не светить паспортными данными вообще нигде. После отмонтирования контейнера на ПК не будет никаких следов ПД, кроме выходных PDF/DOCX/ODT-файлов (вот с ними - да, надо быть аккуратнее).Единственное, в чем может потребоваться помощь айтишника - это подсказать что 1С (все ПД лежат там) злонамеренно ограничивает число кодировок при экспорте таблиц (Сохранить как) и что cp1251 (Win) легко заменяется на utf-8 (Unicode) в LibreOffice.Конечно же, айтишнику есть что улучшить даже в этой схеме. Например, готовый \"слиянием\" PDF может содержать не только элементы управления, но и код, который будет его обрабатывать. Это или JavaScript (мехнизм PDF), или StarBasic/Python/Java/JavaScript, внедренный внутрь PDF по установке галочки \"гибридный\" PDF. По сути вы получаете PDF-контейнер, в котором находится \"заряженный\" макросами ODT (OpenDocumentFormat), и он может бесконечно перезаполняться слиянием многократно (при открытии в OpenOffice|LibreOffice), но останется \"обычным\" PDF для всех остальных, кому это не нужно. Ничего подобного ни один платный \"офис\" и другие свободные пакеты пока не умеют и еще очень долго не смогут."
    },
    {
      "id": 27357294,
      "author": "UncleJonathan",
      "datetime": "2024-09-30T05:38:49.000Z",
      "text": "Очень актуально (сарказм) с учётом того, что подобные продукты заблокируют в течение нескольких недель или месяцев либо с той, либо с другой стороны. И все усилия насмарку.Кроме того, Google и другие корпорации зарабатывают на продаже персональных данных. И вот такие чувствительные данные дарить им для анализа и продажи... Думаю, что даже если это законно (я не юрист), то должно быть незаконно.Я бы очень не хотел, чтобы бухгалтерия моей компании работала даже не в Google Docs, а в принципе, в любом облаке (кроме разве что своего собственного)."
    },
    {
      "id": 27357454,
      "author": "vedmak3",
      "datetime": "2024-09-30T06:32:53.000Z",
      "text": "Ммм персоналка в гугл доках это так по нашему."
    },
    {
      "id": 27359398,
      "author": "aborouhin",
      "datetime": "2024-09-30T12:57:18.000Z",
      "text": "Для бухгалтерии логичнее было бы к 1С прикрутить конструктор договоров, который и проводил бы их в учёте заодно. Благо есть и готовые решения на рынке.А вот что мне очень интересно (и Вашим кредиторам наверняка тоже :) - что же это за организация, у которой возникает потребность штамповать в товарных количествах договоры дарения (!) физикам..."
    },
    {
      "id": 27359690,
      "author": "servspb",
      "datetime": "2024-09-30T14:21:09.000Z",
      "text": "Такой же вопрос."
    },
    {
      "id": 27362208,
      "author": "Old_paranoid",
      "datetime": "2024-10-01T07:52:26.000Z",
      "text": "Ой, да ладно, вы-таки шо, все из налоговой?Навскидку - благотворительные раздачи и выплаты; волонтерские бонусы; программа корпоративного поощрения; лотерея (и корпоративная тоже).Я, лично, ставлю на п.1.Но тут опасность немного другого плана - не знаю, как там на уровне благотворительных фондов устраивают миксер и как финмон раскручивает цепочки источников финансирования, но, по идее, при закручивании гаек - получатели этих подарков могут внезапно увидеть себя в списке иноагентов."
    },
    {
      "id": 27362586,
      "author": "servspb",
      "datetime": "2024-10-01T09:12:16.000Z",
      "text": "Да какая налоговая? Просто, скажем так, необычный сценарий. Вот и стало интересно, что же там такое происходит."
    },
    {
      "id": 27365018,
      "author": "aborouhin",
      "datetime": "2024-10-01T19:12:50.000Z",
      "text": "Более реалистичный сценарий - в случае банкротства организации все одаряемые внезапно увидят себя в списке ответчиков."
    },
    {
      "id": 27359740,
      "author": "proneta",
      "datetime": "2024-09-30T14:35:01.000Z",
      "text": "Похоже, тут тока налог 13%, нет всего остального. Контора до первой проверки ? Или  ЗАО \" Чорные риелторы Москвы\" ? Тогда можно и 13% реструкторизировать до 0"
    },
    {
      "id": 27360956,
      "author": "servspb",
      "datetime": "2024-09-30T21:04:30.000Z",
      "text": "Даже если платить полностью по черному, то все равно где-то надо наличку брать. А я, почему-то, не слышал, чтобы кто-нибудь бесплатно менял, эту самую наличку, на безнал."
    },
    {
      "id": 27361288,
      "author": "proneta",
      "datetime": "2024-10-01T02:42:35.000Z",
      "text": "Вот, видите, как вы уже грамотно обсуждаете уход от налогов. Вам уже и 13% с оборота не устраивает.  Я бы порекомендовал для ЗАО как то через дивиденды уводить деньги. Но это не точно. Были счастливые времена , когда наличку с рынков или даже церквей Гундяева получали под 1%. Но это надо серьёзный бизнес-план с такими же оборотами. Все одобрения собрать, всю защиту получить. Налоговая там на последнем месте :)"
    },
    {
      "id": 27362556,
      "author": "servspb",
      "datetime": "2024-10-01T09:07:29.000Z",
      "text": "А я то здесь при чём? Ко мне, эта ситуация, ни какого касательства не имеет. Да и 13% с оборота - это какая-то дичь. Без всяких кривых схем, на УСН, будет меньше."
    },
    {
      "id": 27363270,
      "author": "proneta",
      "datetime": "2024-10-01T12:07:14.000Z",
      "text": "Ну, если людям критично скорость вывода договоров-1 секунда уже не устраивает. Значит, это серьёзные обороты?. Ну конечно, можно. Привязаться ко времени приходящего бухгалтера, она приходит раз в месяц, штампует за час  всю массу размером с бюджет области. На УСН есть ограничение оборотов. Так и пост появился после ареста Блиновской. Она как раз и просекла , что лучше прогнать пару миллиардов через договор дарения, чем в СИЗО.Олеговна ! Встречаем на свободе. Выучи Word и будешь спать спокойно"
    },
    {
      "id": 27361358,
      "author": "proneta",
      "datetime": "2024-10-01T03:58:52.000Z",
      "text": "В MS Office 💯 лет назад была система печати конвертов. Выполняла те же задачи: один шаблон, минимальная встроенная база, сотни экземпляров одной кнопкой. Это встроенная опция для секретарш. Обходились без Excel.В Windows еще из 90-х осталась связь через ODBC. Кроме Word,  Excel ее видят разные проги, которые ее знают. Я привязывал AutoCAD к Excel. Access , само собой,  тоже подходит.Word нужна только 1 цифра — номер договора, все остальное он возьмёт из нужной строки Excel. Скрипты и макросы здесь не нужны."
    },
    {
      "id": 27365686,
      "author": "zvg197",
      "datetime": "2024-10-02T01:59:24.000Z",
      "text": "Не очень хороший код - преобразование чисел в пропись."
    },
    {
      "id": 27365688,
      "author": "empenoso",
      "datetime": "2024-10-02T01:59:45.000Z",
      "text": "Он из другой статьи - указано откуда"
    },
    {
      "id": 27383898,
      "author": "GreyArt",
      "datetime": "2024-10-06T13:05:36.000Z",
      "text": "Кек, у нас в региональной системе загружаются шаблоны в виде ворд документа в которые через alt+f9 добавляются теги отвечающие за данные в документах системы. В целом штука прикольная, но жутко неудобная в плане редактирования шаблона. Правда речь о научить сотрудников ею пользоваться не идёт, все что они делают - выбирают название шаблона и кнопку генерации документа. Я так понимаю в 1с есть нечто подобное, мне кажется если настроить все правильно тётушки из бухгалтерии будут вместо 4 секунд на 1 договор тратить 1 секунду на 4."
    }
  ]
}