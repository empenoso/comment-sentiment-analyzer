{
  "url": "https://habr.com/ru/articles/503646/comments/",
  "article_id": 503646,
  "title": "Умная хрущёвка на максималках",
  "comments": [
    {
      "id": 21683752,
      "author": "REPISOT",
      "datetime": "2020-06-01T03:13:36.000Z",
      "text": "Не очень понял историю с датчиком шума. Для чего все-таки он нужен? Вы вроде ссылаетесь на нормы СанПиН и возможные нарушения со стороны соседей, но как в борьбе с шумом поможет этот датчик? Как я понимаю, он не внесен в госреестр средств измерения и не поверен. Уровень шума снимается без представителей власти (или хотя бы ЖКХ), без понятых, не заактирован. А значит, его показания в любой инстанции — филькина грамота."
    },
    {
      "id": 21683754,
      "author": "empenoso",
      "datetime": "2020-06-01T03:18:33.000Z",
      "text": "Да, это так — его потом нигде не предъявить и это не акт, но этот уровень шума нужен лично для меня. Чтобы объективно знать, что и как там было."
    },
    {
      "id": 21690514,
      "author": "gluck59",
      "datetime": "2020-06-02T14:09:02.000Z",
      "text": "Но ведь с этой задачей прекрасно справляются человеческие уши? Причем с тем же результатом."
    },
    {
      "id": 21690678,
      "author": "empenoso",
      "datetime": "2020-06-02T14:53:09.000Z",
      "text": "Если они там, а если нет?"
    },
    {
      "id": 21730024,
      "author": "3aBulon",
      "datetime": "2020-06-12T04:35:48.000Z",
      "text": "Ну тогда и уровень шума, наверное, не важен.Начинает сосед сверлить сверху — одеваемся и идем гулять.Уже пятый год сверлит, зараза… в Однушке."
    },
    {
      "id": 21684778,
      "author": "drWhy",
      "datetime": "2020-06-01T09:26:31.000Z",
      "text": "Имея логи работы соседского перфоратора можно выбрать время для приглашения комиссии."
    },
    {
      "id": null,
      "author": "Неизвестный пользователь",
      "datetime": "Дата не найдена",
      "text": "Комментарий пуст"
    },
    {
      "id": null,
      "author": "empenoso",
      "datetime": "2020-06-01T04:17:48.000Z",
      "text": "Я ставил датчик широкого спектра газов MQ-2 в первоначальном варианте. Но он не особенно помогал."
    },
    {
      "id": 21683790,
      "author": "empenoso",
      "datetime": "2020-06-01T04:17:48.000Z",
      "text": "Я ставил датчик широкого спектра газов MQ-2 в первоначальном варианте. Но он не особенно помогал."
    },
    {
      "id": 21683826,
      "author": "empenoso",
      "datetime": "2020-06-01T04:36:45.000Z",
      "text": "Показания странные с него были."
    },
    {
      "id": 21683920,
      "author": "VT100",
      "datetime": "2020-06-01T05:22:49.000Z",
      "text": "Установлен он, если не путаю, у окна? Вот сквознячки с конвекцией и измеряет.ДСка в термоусадке на батарее — тоже погоду на Марсе даёт.Межприборный I²C — зло. Как и идея приёма RS485 через USB."
    },
    {
      "id": 21683940,
      "author": "empenoso",
      "datetime": "2020-06-01T05:34:31.000Z",
      "text": "От MQ-2 отказался в итоге, сейчас его нет. Он прямо рядом с газовой плитой был установлен."
    },
    {
      "id": 21683944,
      "author": "empenoso",
      "datetime": "2020-06-01T05:35:50.000Z",
      "text": "ДСка в термоусадке на батарее — в целом не поверенное устройство конечно, но в рамках той точности, которая была мне нужна — мне кажется вполне справляется."
    },
    {
      "id": 21686738,
      "author": "V1RuS",
      "datetime": "2020-06-01T16:03:30.000Z",
      "text": "ее бы хоть поролоном обмотать, а то ведь занижает температуру на пару градусов"
    },
    {
      "id": 21686762,
      "author": "empenoso",
      "datetime": "2020-06-01T16:07:53.000Z",
      "text": "Поролоном обмотать?"
    },
    {
      "id": 21687080,
      "author": "Osnovjansky",
      "datetime": "2020-06-01T17:19:38.000Z",
      "text": "Сейчас датчик температуры показывает какую-то среднюю температуру между температурой трубы и температурой сквозняка, который обдувает датчик.От сквозняка надо теплоизолировать."
    },
    {
      "id": 21687088,
      "author": "empenoso",
      "datetime": "2020-06-01T17:20:27.000Z",
      "text": "В этом есть резон. Спасибо."
    },
    {
      "id": 21687938,
      "author": "radonit",
      "datetime": "2020-06-01T22:03:01.000Z",
      "text": "А всё равно не поможет, врать будет безбожно, что я только не делал, по хорошему надо датчик через тройник прямо в воду вводить (как на предприятиях делают)"
    },
    {
      "id": 21685112,
      "author": "Dima_Sharihin",
      "datetime": "2020-06-01T10:28:29.000Z",
      "text": "Если трансивер изолированный, а USB — через FTDI, то какие проблемы?"
    },
    {
      "id": 21685266,
      "author": "VT100",
      "datetime": "2020-06-01T11:03:23.000Z",
      "text": "Два если и необязательная \"прокладка\" с дополнительным энергопотреблением. На практике — бывает, что виснет не только USB-device, но и USB-host.На \"малине\", думаю, старый добрый COM-порт ещё не отменили?А так, конечно, дело вкуса и помеховой обстановки. Работает — и ладно."
    },
    {
      "id": 21685346,
      "author": "Dima_Sharihin",
      "datetime": "2020-06-01T11:21:44.000Z",
      "text": "На \"малине\", думаю, старый добрый COM-порт ещё не отменили?На малине единственный UART и к тому подключен bluetooth. Вообще RPi — не лучшая железка для таких задач"
    },
    {
      "id": 21685422,
      "author": "empenoso",
      "datetime": "2020-06-01T11:36:10.000Z",
      "text": "Похоже вы знаете о чем пишете"
    },
    {
      "id": 21683830,
      "author": "makon",
      "datetime": "2020-06-01T04:43:16.000Z",
      "text": "Правильно ли я вас понял что по квартире протянуты многометровые линии интерфейса i2c?"
    },
    {
      "id": 21683834,
      "author": "empenoso",
      "datetime": "2020-06-01T04:45:05.000Z",
      "text": "Сейчас фактически да, после переустройства на новую версию с цифровыми датчиками."
    },
    {
      "id": 21683842,
      "author": "empenoso",
      "datetime": "2020-06-01T04:47:14.000Z",
      "text": "Причём изначально я не очень разобрался и всё они подключены звездой, а не шиной, как и должно быть."
    },
    {
      "id": 21686748,
      "author": "V1RuS",
      "datetime": "2020-06-01T16:05:44.000Z",
      "text": "и как стабильность?я один раз RS-485 развел звездой, нормально не работало, хоть и расстояния небольшие, в пределах 20 м. Пришлось распараллелить на отдельные \"шины\" из трех точек."
    },
    {
      "id": 21686770,
      "author": "empenoso",
      "datetime": "2020-06-01T16:08:50.000Z",
      "text": "В итоге заработало звездой, но так лучше не делать."
    },
    {
      "id": 21683988,
      "author": "kasigor",
      "datetime": "2020-06-01T05:52:21.000Z",
      "text": "А малинка в корпусе летом нормально держится без кулера, сколько градусов? Что за ОС на ней стоит?"
    },
    {
      "id": 21683990,
      "author": "empenoso",
      "datetime": "2020-06-01T05:56:30.000Z",
      "text": "СейчасHass.io — Home Assistant, до этогоopenHABian — Hassle-free openHAB Setup."
    },
    {
      "id": 21683992,
      "author": "empenoso",
      "datetime": "2020-06-01T05:58:16.000Z",
      "text": "Малинка летом нормально держится без кулера, сколько градусов не мониторю, но все эти годы были проблемы только из-за карт памяти. И один раз БП не тот поставил — пришлось купить новую :)"
    },
    {
      "id": 21684006,
      "author": "kasigor",
      "datetime": "2020-06-01T06:03:22.000Z",
      "text": "А карты памяти сколько живут у Вас в малинке? У меня Ubuntu Server 18 стоит на карте Sandisk 16гб. Мне интересно сколько протянет у меня. Уже uptime 45 дней на сегодня."
    },
    {
      "id": 21684018,
      "author": "empenoso",
      "datetime": "2020-06-01T06:06:42.000Z",
      "text": "Точную статистику не веду, по ощущениям год или два."
    },
    {
      "id": null,
      "author": "empenoso",
      "datetime": "2020-06-01T08:34:06.000Z",
      "text": "Да даже и на SD — мне кажется достаточно иметь актуальную резервную копию."
    },
    {
      "id": 21684522,
      "author": "empenoso",
      "datetime": "2020-06-01T08:34:06.000Z",
      "text": "Да даже и на SD — мне кажется достаточно иметь актуальную резервную копию."
    },
    {
      "id": null,
      "author": "Неизвестный пользователь",
      "datetime": "Дата не найдена",
      "text": "Комментарий пуст"
    },
    {
      "id": null,
      "author": "kasigor",
      "datetime": "2020-06-01T10:51:01.000Z",
      "text": "Ясно. С 23 мая в новой прошивке Pi4 есть загрузка с USB."
    },
    {
      "id": 21685212,
      "author": "kasigor",
      "datetime": "2020-06-01T10:51:01.000Z",
      "text": "Ясно. С 23 мая в новой прошивке Pi4 есть загрузка с USB."
    },
    {
      "id": null,
      "author": "Неизвестный пользователь",
      "datetime": "Дата не найдена",
      "text": "Комментарий пуст"
    },
    {
      "id": null,
      "author": "Неизвестный пользователь",
      "datetime": "Дата не найдена",
      "text": "Комментарий пуст"
    },
    {
      "id": 21685360,
      "author": "Felar",
      "datetime": "2020-06-01T11:23:35.000Z",
      "text": "спасает только перевод в R/O. и ежесуточный перевод в R/W и обратно для сброса накопившихся данных. tmpfs наше все. до этого приходилось менять sd-карты раз в месяц-два."
    },
    {
      "id": 21685362,
      "author": "booyakacrew",
      "datetime": "2020-06-01T11:23:38.000Z",
      "text": "Подключил внешний HDD (ноутбучный, в кармане, после апгрейда ноута на ssd) и бутаюсь/держу систему на нём. бОльшая часть диска отдана в smbfs под сетевую шару. На SD карте только бекап."
    },
    {
      "id": 21688906,
      "author": "Divisi0n",
      "datetime": "2020-06-02T08:10:42.000Z",
      "text": "Карты памяти убивает запись логов, их следует отключать по максимуму."
    },
    {
      "id": 21684022,
      "author": "romanetz_omsk",
      "datetime": "2020-06-01T06:07:02.000Z",
      "text": "Счётчики для воды есть с ble интерфейсом, они в реестре и поверенные — элехант. У приятеля esp32 их принимает, отдаёт уже по mqtt, это готовый проект из интернета взят, я его только из vs code в Ардуино ide перенёс. Цена вопроса 300р за esp32, счётчики в районе тысячи каждый.Газовый счётчик пр-ва эльстер, мебранного типа — это важно для котлов, у таких счётчиков самое низкое падение давления — имеет возможность прицепить геркон, но цена негуманная. Решил тоже через ble, nrf52840+hmc5883 (датчик магнитного поля). Принимает та же esp32."
    },
    {
      "id": 21684030,
      "author": "empenoso",
      "datetime": "2020-06-01T06:10:35.000Z",
      "text": "Про счетчики воды с Bluetooth я слышал, но появились они не так уж и давно и на профильном форуме их ужасно ругали. Возможно мы говорим про разные марки — точно не помню."
    },
    {
      "id": 21684032,
      "author": "empenoso",
      "datetime": "2020-06-01T06:13:17.000Z",
      "text": "На каком максимальном удалении от счетчика можно ставить esp32?"
    },
    {
      "id": 21685840,
      "author": "romanetz_omsk",
      "datetime": "2020-06-01T12:56:52.000Z",
      "text": "Тесты специально не проводил, у меня дома это единицы метров, 5-6 + стена."
    },
    {
      "id": 21685976,
      "author": "empenoso",
      "datetime": "2020-06-01T13:30:49.000Z",
      "text": "А коннект насколько надежно?"
    },
    {
      "id": 21684230,
      "author": "tnt4brain",
      "datetime": "2020-06-01T07:24:58.000Z",
      "text": "Для этой серии счётчиков датчик называется IN-Z61, ищется в интернете, вроде от 1100 руб. Насколько гуманно — каждый сам решает."
    },
    {
      "id": 21684234,
      "author": "empenoso",
      "datetime": "2020-06-01T07:27:25.000Z",
      "text": "В разы дешевле чем с RS485. А что по надёжности?"
    },
    {
      "id": 21684272,
      "author": "tnt4brain",
      "datetime": "2020-06-01T07:38:43.000Z",
      "text": "Это, я думаю, лучше у производителя спросить. Интерфейс типа «сухой контакт» на герконе — а что с ним может случиться? Сам производитель позиционирует датчик как оптимальный способ апгрейда существующих счётчиков своей марки до решения с диспетчеризацией, тем более, что вся метрология — именно в счётчике.Ну и непосредственно на сайте по неким причинам (маркетинг счётчиков со встроенными средствами телеметрии?) производитель эти датчики не описывает."
    },
    {
      "id": 21684400,
      "author": "empenoso",
      "datetime": "2020-06-01T08:10:03.000Z",
      "text": "Я думал мы про блютус говорим, а вы имеете ввидуДатчик импульсов IN-Z61?Это просто какое-то закрытое решение. И протокол закрыт. Лично в моем случае смысла в нём нет."
    },
    {
      "id": 21684412,
      "author": "tnt4brain",
      "datetime": "2020-06-01T08:13:34.000Z",
      "text": "Протокол у датчика импульсов с «сухим контактом» на выходе? Вы троллите? Даже на фото по вашей ссылке вполне различима внутренняя схема датчика, которая нанесена производителем на корпус."
    },
    {
      "id": 21684428,
      "author": "empenoso",
      "datetime": "2020-06-01T08:19:07.000Z",
      "text": "Видимо мы о разных вещах говорим.Я почему-то думал, что вы о говорите о блютус счетчике на воду — вы же в этой ветке комментариев стали писать:"
    },
    {
      "id": 21684448,
      "author": "empenoso",
      "datetime": "2020-06-01T08:23:11.000Z",
      "text": "Аа, вы про газовый счётчик имели ввиду…"
    },
    {
      "id": 21684644,
      "author": "tnt4brain",
      "datetime": "2020-06-01T08:59:52.000Z",
      "text": "Да, верно."
    },
    {
      "id": 21684038,
      "author": "ionicman",
      "datetime": "2020-06-01T06:15:27.000Z",
      "text": "Скажите, а что у вас автоматически дома делается? Какие сценарии, ну кроме света и \"отключить все\"?"
    },
    {
      "id": 21684046,
      "author": "empenoso",
      "datetime": "2020-06-01T06:18:12.000Z",
      "text": "Это частый вопрос. Конкретно в этом случае ничего особенного и можно посмотреть в репозитории:github.com/empenoso/Home-Assistant_two-bedroom-flat/blob/master/automations.yaml"
    },
    {
      "id": 21684120,
      "author": "ionicman",
      "datetime": "2020-06-01T06:46:53.000Z",
      "text": "Это как раз не частный вопрос.Просто у вас ни разу не умный дом, без обид. Это ни разу не уменьшает того, что вы сделали.Но количество таких вот статей про \"умный\" дом, который на самом деле ни разу не умный, постоянно растёт."
    },
    {
      "id": 21684126,
      "author": "empenoso",
      "datetime": "2020-06-01T06:50:30.000Z",
      "text": "Без подобной подготовки, как у меня, умный дом сделать невозможно.Откуда брать информацию — только с датчиков, других устройств (роутер, телевизор, ...). Как управлять — только исполнительными устройствами.Правила не показаны в репозитории — это да, но ведь у каждого они свои.Вот у вас например какие автоматические действия выполняются?"
    },
    {
      "id": 21684134,
      "author": "empenoso",
      "datetime": "2020-06-01T06:52:57.000Z",
      "text": "Поищите по тексту статьи Ctrl+F (Cmd+F) «умный дом» — вы удивитесь."
    },
    {
      "id": 21684116,
      "author": "DaemonGloom",
      "datetime": "2020-06-01T06:46:38.000Z",
      "text": "Вообще из автоматических сценариев часто делают уборку в выходные/будни, когда дома никого нет; разнообразные уведомления; групповое управление техникой. Плюс это способ свести управление разными частями в одну панель управления. У меня там есть ещё отслеживание сертификатов, управление transmissionbt и сервером plex. Плюс контроль за состоянием сервера HP с отправкой push при проблемах."
    },
    {
      "id": 21684176,
      "author": "empenoso",
      "datetime": "2020-06-01T07:06:27.000Z",
      "text": "Главное только потом не забить на уведомления :) У меня бывало."
    },
    {
      "id": 21686230,
      "author": "info86",
      "datetime": "2020-06-01T14:23:43.000Z",
      "text": "Какой у вас сервер hp? Не из линейки microserver? Если да, то как мониторинг осуществляется?"
    },
    {
      "id": 21686484,
      "author": "DaemonGloom",
      "datetime": "2020-06-01T15:10:22.000Z",
      "text": "У меня microserver gen8, но стандартная интеграция из home assistant работает с разными версиями ilo без проблем. Отслеживаю температуру, скорость кулера и состояния дискового массива.www.home-assistant.io/integrations/hp_iloБыл бы сервер чуть умнее — можно было бы ещё и потребление смотреть, но в ms gen8 такой возможности нет."
    },
    {
      "id": 21686648,
      "author": "info86",
      "datetime": "2020-06-01T15:49:05.000Z",
      "text": "У меня такой же ген8. Даже не знал что есть такая интеграция, спасибо большое. Состояние дисков тоже показывает в ХА?Ещё в процессе переноса с малины на эту железку.У тебя как всё это установлено? Esxi стоит? В ней виртуалка и убунту?А сам ХА в докере стоит или по другому как-то?"
    },
    {
      "id": 21688198,
      "author": "DaemonGloom",
      "datetime": "2020-06-02T03:38:49.000Z",
      "text": "Состояние дисков показывает как ok/degraded.Пример конфига- platform: hp_ilo\n    host: !secret ilo_ip\n    username: !secret ilo_login\n    password: !secret ilo_password\n    monitored_variables:\n      - name: Power\n        sensor_type: server_power_status\n      - name: Uptime\n        sensor_type: server_power_on_time\n      - name: CPU fanspeed\n        sensor_type: server_health\n        unit_of_measurement: '%'\n        value_template: '{{ ilo_data.fans[\"Fan 1\"].speed[0] }}'\n      - name: Inlet temperature\n        sensor_type: server_health\n        unit_of_measurement: '°C'\n        value_template: '{{ ilo_data.temperature[\"01-Inlet Ambient\"].currentreading[0] }}'\n      - name: storage_status\n        sensor_type: server_health\n        value_template: \"{{ ilo_data.health_at_a_glance['storage']['status'] }}\"ESXi, на котором живут виртуалки. Одна из них — hass.io (нынче называется просто home assistant, не путать с core)."
    },
    {
      "id": 21685192,
      "author": "tester12",
      "datetime": "2020-06-01T10:47:01.000Z",
      "text": "Я бы понял автоматизацию в офисном центре или в огромном особняке. Но тут… зачем?Выключить свет в двух комнатах — занимает одну минуту. Переписать цифры со счётчиков — примерно столько же. Температурные датчики всё равно никак не повлияют на температуру подаваемой воды (и, кстати, датчики нужно изолировать от окружающего воздуха, иначе они будут показывать заниженную температуру). Настенный дисплей с часами и температурой… эээммм… а в мобиле часов и погоды нет?Короче, я не понял, какая польза от всей этой «умности»."
    },
    {
      "id": 21685376,
      "author": "empenoso",
      "datetime": "2020-06-01T11:24:30.000Z",
      "text": "Ну не знаю, а мне понравилось :)"
    },
    {
      "id": 21688268,
      "author": "nveresha",
      "datetime": "2020-06-02T04:48:04.000Z",
      "text": "А работы… а где голосовое управление и искусственный интеллект)Но удаленное включение света моя 8-летняя дочь оценит на все 100 баллов. Да и любой младший школьник…"
    },
    {
      "id": 21686002,
      "author": "danon13",
      "datetime": "2020-06-01T13:34:40.000Z",
      "text": "Мне кажется, применение найти можно всегда. У меня, например, 4 счётчика воды, расположенные не очень удобно, при этом автоматизировать можно и отправку этих сведений.Измерение температуры воды может так же сигнализировать о некотором постоянном её изменении ниже (или выше) установленных норм. Как выше писали, так же можно пригласить службу в конкретное время."
    },
    {
      "id": 21686010,
      "author": "empenoso",
      "datetime": "2020-06-01T13:36:05.000Z",
      "text": "Конкретно в Перми автоматизировать отправку этих сведений слегка проблематично. Нет API.А в остальном согласен."
    },
    {
      "id": 21686150,
      "author": "Nikobraz",
      "datetime": "2020-06-01T14:06:35.000Z",
      "text": "Даже путь в тысячу ли начинается с первого шага.Если бы обезьяна взявшая в руки камень бросила бы его, не создав каменный топор, ведь и палкой можно охотиться, руками ломать ветки, где было бы человечество.А подобные штуки, это уют айтишника. Делать свой дом удобнее и функциональнее."
    },
    {
      "id": 21686168,
      "author": "empenoso",
      "datetime": "2020-06-01T14:09:21.000Z",
      "text": ""
    },
    {
      "id": null,
      "author": "empenoso",
      "datetime": "2020-06-01T11:30:29.000Z",
      "text": "Поставил один мощный 220v AC -> 12v DC от Mean Well, а если надо 5v DC от него уже 12v DC -> 5v DC (только для малины и понадобилось).Это фото просто во вторую часть статьи переехало."
    },
    {
      "id": 21685392,
      "author": "empenoso",
      "datetime": "2020-06-01T11:30:29.000Z",
      "text": "Поставил один мощный 220v AC -> 12v DC от Mean Well, а если надо 5v DC от него уже 12v DC -> 5v DC (только для малины и понадобилось).Это фото просто во вторую часть статьи переехало."
    },
    {
      "id": null,
      "author": "empenoso",
      "datetime": "2020-06-01T13:34:28.000Z",
      "text": "1. Можно dc-dc преобразователи использовать.2. Если например усилитель звука и питание источника сигнала (Raspberry Pi) — тогда да — ужасно шумит и помехи. А в других случаях просто всё накроется за раз. Но замена проще :)"
    },
    {
      "id": 21685998,
      "author": "empenoso",
      "datetime": "2020-06-01T13:34:28.000Z",
      "text": "1. Можно dc-dc преобразователи использовать.2. Если например усилитель звука и питание источника сигнала (Raspberry Pi) — тогда да — ужасно шумит и помехи. А в других случаях просто всё накроется за раз. Но замена проще :)"
    },
    {
      "id": 21686140,
      "author": "Ajex",
      "datetime": "2020-06-01T14:04:48.000Z",
      "text": "Интересно, а хоть что-то из этого пригодилось в реальной жизни? Чем пользуетесь больше всего?Себе проектирую нечто подобное, но у себя упор сделал на удаленное управление отоплением на уровне комнат в частном доме. А также управление освещением (диммирование, автоматическое включение света,led подсветок ). Пришел к тому, что тянул все силовые линии и выключатели прямо в щиток без распредкоробок, а в нем уже на реле делал всю коммутацию. Получилось, к удивлению, не сильно избыточно по проводам, зато полный простор по управлению, диммированию, созданию отключаемых/неотключаемых мастер рубильником групп.До счетчиков еще не добрался, но честно говоря, не вижу смысла брать сертифицированные с интерфейсом. Я планирую рядом с водоканаловскими счетчиками поставить свои, какие мне будет удобно подключать и снимать с них показания. Даже если будет расхождение в показаниях, можно иногда вносить коррективы, все равно нету толку от той точности."
    },
    {
      "id": 21686176,
      "author": "empenoso",
      "datetime": "2020-06-01T14:11:59.000Z",
      "text": "В целом ни о чем не жалею, свет по понятным причинам используется чаще всего — даже при нажатии на обычный выключатель это ведь все равно все проходит через систему автоматизации."
    },
    {
      "id": 21686890,
      "author": "Ajex",
      "datetime": "2020-06-01T16:34:11.000Z",
      "text": "я думаю тут больше жизненного опыта и фана, чем прямой необходимости :).Кстати у вас как-то слабо описана именно схема проводки. Лично мне больше интересен был бы этот опыт. Потому, как у меня именно правильная разводка кабелей вызвала самые большие затруднения.Сейчас вот планирую ремонт в 3-ке, хочу свести все лини света в щиток без разрывов на распредкоробках. А от каждого выключателя, также в щиток, провести слаботочный 8и жильный управляющий кабель. Т.е. из одной точки я без контроллера смогу включать до 7-и линий света. А с контроллером до бесконечности. Тут уже простор для дальнейшего творчества. Можно ставить любые выключатели. Управлять светом из приложения. Также легко организовать диммирование любой световой линии."
    },
    {
      "id": 21686952,
      "author": "empenoso",
      "datetime": "2020-06-01T16:47:31.000Z",
      "text": "Вам тогда лучше про вот этот мой опыт прочитать:habr.com/ru/post/489610Здесь всё же компромисс с проводкой, а там нет."
    },
    {
      "id": 21687352,
      "author": "Ajex",
      "datetime": "2020-06-01T18:34:33.000Z",
      "text": "ага, как-то просмотрел схему укладки сетей. У меня к вам будет несколько вопросов, если можно.1). Что сейчас вы бы изменили в этой схеме прокладки слаботочных/силовых кабелей? Например все равно бы тянули все эти кабеля без разрывов или где-то все же проще было сделать пару промежуточных распредкоробок, чтобы разгрузить центральный щит.2). Вижу сигнальный кабель во многих местах пересекается с силовым. Не создавало ли это каких-либо помех?3). Не думали, что проще (да и по факту дешевле) было бы использовать в качестве управляющего какой-либо вариант промышленной последовательной шины. Или вообще в комплексе что-то типо Larnitech-а?4). Не упростило бы монтаж использование 4-5 жильного силового кабеля с локальной перекомутацией через те же розетки или светильники. Просто даже 4 жилы вместо 3-х позволило бы сократить кол-во силовых кабелей в 2 раза."
    },
    {
      "id": 21688162,
      "author": "vinogradovoleg",
      "datetime": "2020-06-02T03:06:43.000Z",
      "text": "у меня в частном автоматизация завершена на 70%. могу ответить на вопросы:1) никаких распред коробок для слаботочки, во всяком случае у меня их нет, витухи я уже заложил около 600 метров. я закидывал в каждую комнату 8-жильный на свет и 8-жильный на датчики. Лучше все в одно место. самое главное электрощит побольше (я уже переехал из 36 модульного на 56 и места почти кончилось. причем локалка у меня в серверном шкафе в другом месте.2) сколько лет занимаюсь сисадминством ни разу у меня не было проблем из-за силовых кабелей. Даже в цехах с utp обычной, где витуха кинута вдоль электрики вплотную больше 50 метров. дома точно ничего не помешает.3) Куда же дешевле MegaDевайса? Проще это homekit от apple.4) для розеток у меня в каждую комнату заходит свой кабель на 2.5 со своим автоматом в щитке.коммутация в распаянной коробке. На свет я использовал 5х1.5 в каждую комнату. а дальше 2х1.5 к лампочке. коммутация в распаянной коробке."
    },
    {
      "id": 21688166,
      "author": "empenoso",
      "datetime": "2020-06-02T03:08:08.000Z",
      "text": "Согласен."
    },
    {
      "id": 21688570,
      "author": "VT100",
      "datetime": "2020-06-02T06:56:32.000Z",
      "text": "2) сколько лет занимаюсь сисадминством ни разу у меня не было проблем из-за силовых кабелей. Даже в цехах с utp обычной, где витуха кинута вдоль электрики вплотную больше 50 метров. дома точно ничего не помешает.Потому, что физический уровень Ethernet балансный и с гальванической изоляцией.Работоспособность авторского I²C выглядит чудом. Хотя можно и его надёжность приподнять аппаратно-программными методами."
    },
    {
      "id": 21689580,
      "author": "empenoso",
      "datetime": "2020-06-02T10:29:12.000Z",
      "text": "А почему тогда никто другой на эту тему больше не высказался?"
    },
    {
      "id": 21690078,
      "author": "RuLooper",
      "datetime": "2020-06-02T12:10:36.000Z",
      "text": "Почему же? В сообществе HomeAssistant регулярно обсуждают проблемы обмена с датчиками DS18b20)"
    },
    {
      "id": 21691248,
      "author": "VT100",
      "datetime": "2020-06-02T17:51:12.000Z",
      "text": "Думаю — вот.Что касается 1-wire на длинной линии, то это отчасти можно победить. Например — подстройкой времянок в соответствии с характеристиками проложенных кабелей и мажорированием при приёме \"1\". Но это уже потребует отказа от программных примитивов ардуино и перехода, как минимум, на Си."
    },
    {
      "id": 21690276,
      "author": "Dima_Sharihin",
      "datetime": "2020-06-02T13:02:23.000Z",
      "text": "Ну, технически I2Cвыживаетв длинных шнурках с HDMI-CEC/VGA EDID. Но он там вроде бы должен быть чуть более защищенным, чем просто дорожки на плате.Примерно как встатье на hackaday"
    },
    {
      "id": 21691824,
      "author": "Ajex",
      "datetime": "2020-06-02T21:20:00.000Z",
      "text": "У меня под температурые датчики I2C / датчики движения в проекте заложена витуха 5cat. Длины около 15 метров. Изначально я понимал, что это идеологически неверный подход, хотя тесты на том же кабеле показывали, что система работает даже на длине в 100 метров. Просто реально не нашел какой-либо дешевой альтернативы, а RS485 был бы дико избыточен для моих целей. Так что решил пока заложить такие кабеля, а потом уже решать вопрос со связью.В случае неудовлетворительно работы всей системы, просто думал изменить датчиков по какой-то стабильный протокол. Пока так и осталось, в тестах работает, посмотрим.Хотя данное решение мне и не нравится."
    },
    {
      "id": 21690066,
      "author": "RuLooper",
      "datetime": "2020-06-02T12:08:23.000Z",
      "text": "По поводу п.2: у меня возникли небольшие проблемы с опросом датчиков температуры и влажности DS18b20 из-за протяженности или из-за прилегающих силовых цепей уж не знаю, но фактически форма сигнала (смотрел осциллом) сильно поменялась от настольного исполнения, что, конечно, логично, но для решения, которое я использовал (HomeAssistant на малине), это оказалось критичной проблемой и приводило к зависанию обмена. Пришлось обходить это ограничение, но это, к сожалению, не всегда возможно("
    },
    {
      "id": 21690048,
      "author": "RuLooper",
      "datetime": "2020-06-02T12:05:05.000Z",
      "text": "У самого есть частичная автоматизация с мозгом-малиной с такими функциями:1. Централизованное управление теплым полом (5 зон).2. Вытяжка в ванной.3. Управление всем светом.4. Датчики температуры/влажности в комнатах.5. Управление увлажнителем.6. Антипротечка.7. Видеонаблюдение.8. Датчики для цветочков :)Все это делал в новой квартире, так что особых сложностей с коммуникациями не было."
    },
    {
      "id": 21690234,
      "author": "empenoso",
      "datetime": "2020-06-02T12:54:14.000Z",
      "text": "А п. 8 можно подробнее?"
    },
    {
      "id": 21690298,
      "author": "RuLooper",
      "datetime": "2020-06-02T13:08:40.000Z",
      "text": "Можно: есть погружные датчики MiFlora (температура, влажность, фертильность почвы, уровень освещенности), которые можно связать с HASS, который крутится на малине. НО! т.к. малина в электрощите, а цветочки на балконе, то связь по блютусу у них не очень получается, поэтому пришлось замутить мост BT-WiFi на платке с ESP32."
    },
    {
      "id": 21690366,
      "author": "empenoso",
      "datetime": "2020-06-02T13:33:32.000Z",
      "text": ""
    },
    {
      "id": 21694148,
      "author": "nsemenoff",
      "datetime": "2020-06-03T14:17:24.000Z",
      "text": "Сейчас существуют устройства с беспроводным подключением типа Sonoff mini и так далее — подключаются по WiFi, не требуют наличия выделенного сервера дома, управлять ими можно через интернет, собрать умный дом с возможность голосового управления от Яндекс.Алиса или Google — это готовое решение.Там же можно найти и контроллеры температуры для теплых полов с дистанционным управлением, счетчики электроэнергии и, наверняка, измерители уровня шума.Просто автоматизация умного дома — полезная вещь, мы такую используем на даче для большинства электроприборов от замков и освещения до контроля температуры в бойлере и теплых полов.Предлагаю переделать описанную хрущевку на современный лад и описать что получится!"
    },
    {
      "id": 21694162,
      "author": "empenoso",
      "datetime": "2020-06-03T14:18:37.000Z",
      "text": "Как раз дописываю во второй части статьи про это. Ориентировочно 15 июня опубликую."
    },
    {
      "id": 21694668,
      "author": "Ajex",
      "datetime": "2020-06-03T16:20:03.000Z",
      "text": "Сонофф — это обычная ESP 8266 с блоком питания за тройную, а то и больше цену. Уж лучше использовать чистую ESP 8266 (те же nodemcu, wemos) с любыми ардуиновскими датчиками/модулями. Во первых облако будет свое (Tasmota, ESPEasy, Blynk ...). Во вторых доступны сразу все ноги, а не только те, что удастся оторвать у соноффа.Если ног будет мало, то можно цеплять бесконечное количество mcp23017 по I2C.Я пока остановился на такой связке контроллер на ESP 8266 (Nodemcu) + mcp23017 +… и свой сервер на blynk. Когда все доделаю, буду наворачивать юзабилити, хотя у того же blynk есть почти все, что надо из коробки."
    },
    {
      "id": 21694680,
      "author": "empenoso",
      "datetime": "2020-06-03T16:22:31.000Z",
      "text": "С Sonoff тоже можно без проблем любую открытую прошивку поставить."
    },
    {
      "id": 21694942,
      "author": "Ajex",
      "datetime": "2020-06-03T17:35:17.000Z",
      "text": "можно, только зачем? Чисто из-за того что это удобная пластиковая коробочка на дин рейку?Я как-то по началу тоже с ними забавлялся. Но по факту все соноффы где-то валяются. У людей на форуме вечные проблемы, как прошить нормальную прошивку, как выкрутиться когда не хватает ног или победить какую-то ветряную мельницу, зачем эти все муки? Если в такой же самой ESP это все из коробки, сразу есть все ноги, все задокументировано, куча совместимых модулей с инструкциями, прошивать удобнее, питать от низкого напряжения и т.д.Хотя развешивать автоматизацию на куче работающих по wifi беспроводных устройств, наверное не самое лучшее решение. Для этого есть другие, для того и созданные протоколы.У меня ESP вообще в качестве прототипа. Чисто макетировать на ней удобно.Куча готовых компонентов с библиотеками. Потом планировал заменить на что-то более надежное.Хотя сейчас уже можно и под stm32 на platformio собирать используя те же библиотеки и компоненты. Хоть и не совсем это true way."
    },
    {
      "id": 21696166,
      "author": "empenoso",
      "datetime": "2020-06-04T03:26:11.000Z",
      "text": "Сонофф просто как пример заводского изделия — можно конечно и DIY всё сделать, но мне кажется это не так безопасно, когда связано с управлением электричеством."
    },
    {
      "id": 21697672,
      "author": "Ajex",
      "datetime": "2020-06-04T10:37:16.000Z",
      "text": "Он такой же «заводской», как и все остальные устройства.Ну я это пишу не для вас, вы-то понимаете, что делаете.А для новичков, которые будут думать, что сонофф это заводское устройство. А по факту, это просто обвязка для модуля ESP 8266 с китайской прошивкой, которую все равно придется потом прошивать на что-то нормальное, а потом бороться с недостатком ног выдумывая всякие костыли.Лучше пропустить эту фазу, и взять сразу что-то действительно заводское (хотя это такое кривое слово). Или, если уж хочется повысить свой опыт и разобраться, как оно все устроено, то лучше взять какой-то «незаводской» контроллер ESP/*duino… к нему добавить «незаводской» модуль (реле, например) + «незаводской» датчик движения.Вот, к примеру, 4-х канальный «заводской» sonoff, первой ревизии,рисунокво второй они добавили аж целый stm32 контроллер, чтобы включать реле по расписанию и который на альтернативной прошивке ведет себя совершенно непредсказуемо.А вот «незаводской» nodemcu esp 8266рисунокс 4х канальным «не заводским» модулем релерисунокСоединив нехитрым образом 6 проводков, получаем такой же «заводской» модуль, только в несколько раз дешевле и с возможностью нормального расширения на бесконечное число управляемых портов и дополнительных модулей за копейки.К тому же при поломке любого из компонентов, который стоит не больше пары баксов, его легко заменить.Я правда, все эти китайские релюхи, заменил на твердотельные (даже made in japan :) ) ибо немного бесит их клацанье в щитке, да и по надежности они так себе."
    },
    {
      "id": 21698436,
      "author": "Osnovjansky",
      "datetime": "2020-06-04T12:45:48.000Z",
      "text": "Вероятно, ваш оппонент читал эти две статьи Олега Артамонова о электробезопасности:раз,дваВ частности, там объяснено, почему подавляющее большинство «обычных» релейных модулей не стоит включать в 220 В надолго.Я бегло погуглил картинки «Sonoff внутри» — судя по прорезям на платах, там какое-то внимание изоляции было уделено, в отличие от обычных модулей ардуинки. (судить гарантированно — мои знания не позволяют — возможно и в Sonoff не всё в порядке)Присмотрелся к фото вашего модуля на 4 реле — вроде бы какие-то прорези там есть. Возможно и не так всё плохо и касательно «обычно» я не прав.Но при этом, «заводские изделия», скорее всего, проходили сертификацию и их проверяли на безопасность, а модули для «ардуинки» — это просто детальки и их нужно проверять самостоятельно. Так что тут вопрос компромисса между деньгами временем и квалификацией."
    },
    {
      "id": 21698786,
      "author": "empenoso",
      "datetime": "2020-06-04T13:50:36.000Z",
      "text": "И подписанные внутренности устройств тоже есть:"
    },
    {
      "id": 21698776,
      "author": "empenoso",
      "datetime": "2020-06-04T13:49:02.000Z",
      "text": "Не надо искать в интернете, у меня есть фотки устройств которые установлены в квартире:"
    },
    {
      "id": 21698896,
      "author": "Ajex",
      "datetime": "2020-06-04T14:12:33.000Z",
      "text": "Ну вот о чем я и говорю, обычная самая дешевая ESP 8266 за бакс + те же китайские реле за 50 центов. При чем высоковольтная и низковольтная части рядом. Не говорю, что это плохо и не правильно, просто сонофф хорош, когда надо быстро автоматизировать отдаленную точку, а не для комплексной автоматизации.Я у себя делал 2 щитка: силовой и слаботочный, в одном, соответственно, вся высоковольтная часть + реле, в слаботочке контроллер, управляющий всем этим делом.Себе ставил вот такие ТТ релерисунокА по поводу сертификации, она есть на сам модуль ESP, который везде одинаков. Со своими + и -. По отзывам в силовом щитке ему не самое лучшее место. Как ни крути — это любительский контроллер. Он хоть и справляется со своей задачей на отлично. Но от того, что его распаяли на плату и нарекли соноффом, ничего не поменялось.Хотя эти ESP-шки чертовски живучи, что я только с ними не вытворял, почти все героически выжили. :D"
    }
  ]
}