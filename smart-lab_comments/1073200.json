{
  "url": "https://smart-lab.ru/blog/1073200.php?nomobile=1",
  "article_id": 1073200,
  "title": "Мой доклад на 35-й конференции Смартлаба в Москве: «Парсинг котировок в Microsoft Excel и Google Таблицы с любого сайта»",
  "comments": [
    {
      "id": 17417308,
      "author": "Разумное инвестирование",
      "datetime": "2024-10-21T07:40:00.000Z",
      "text": "В этом году начал пилить учёт инвестиций в гуглдокс. Результат сильно превзошел ожидания, получилась инвестиционно торговая платформа, с сигналами на покупку и продажу.В результате, перешёл полностью на гуглдокс, отказавшись от сервисов учёта инвестиций.Ваш метод глянул бегло с телефона. Для извлечения каждой котировки вы обращаетесь к xml?"
    },
    {
      "id": 17417373,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T08:15:00.000Z",
      "text": "Николай, в примере да. У этого метода есть ограничения, можно через Google Apps Script переписать всё."
    },
    {
      "id": 17419895,
      "author": "Разумное инвестирование",
      "datetime": "2024-10-21T19:39:00.000Z",
      "text": "Михаил Шардин, такое решение мне видится более оптимальным. По крайней мере у себя я сделал именно через Google Apps Script."
    },
    {
      "id": 17417380,
      "author": "Lazanya0000",
      "datetime": "2024-10-21T08:19:00.000Z",
      "text": "Да тоже использую эксель, но большой минус, что мосбиржа дает данные с 15 минутной задержкой."
    },
    {
      "id": 17417385,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T08:23:00.000Z",
      "text": "Lazanya0000, как вариант можно попробоватьпереписать на использование API брокера со своим ключом. Тогда задержки не будет."
    },
    {
      "id": 17417415,
      "author": "Lazanya0000",
      "datetime": "2024-10-21T08:36:00.000Z",
      "text": "Михаил Шардин, не, ну теперь то все понятно, чего непонятного, все понятно"
    },
    {
      "id": 17417454,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T08:52:00.000Z",
      "text": "Lazanya0000, в России есть несколько брокеров у которых есть свой собственный программный интерфейс.Обычно за подключение к этому интерфейсу никакой дополнительной оплаты не берётся. Может быть вы уже являетесь клиентом одного из этих брокеров.Вы можете получить ключ для доступа к программному интерфейсу и переписать формулы так чтобы получать как клиент этого брокера нужные вам котировки без всякой задержки."
    },
    {
      "id": 17417518,
      "author": "Ramha",
      "datetime": "2024-10-21T09:17:00.000Z",
      "text": "Михаил Шардин, можно сделать такую таблицу с архивом дневных  котировок сбера за 10 лет с ежедневным автообновлением?"
    },
    {
      "id": 17417664,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T10:02:00.000Z",
      "text": "Ramha, можно, только зачем?"
    },
    {
      "id": 17417947,
      "author": "Ramha",
      "datetime": "2024-10-21T11:07:00.000Z",
      "text": "Михаил Шардин, сделать свою таблицу"
    },
    {
      "id": 17418037,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T11:28:00.000Z",
      "text": "Ramha, да, возможно"
    },
    {
      "id": 17418657,
      "author": "Виктор Шеренков",
      "datetime": "2024-10-21T13:46:00.000Z",
      "text": "Lazanya0000, тоже использую данные Мосбиржи. Не заметил задержки. А используетеiss.moex.com//iss/engines/stock...?или что-то другое?"
    },
    {
      "id": 17418663,
      "author": "Lazanya0000",
      "datetime": "2024-10-21T13:48:00.000Z",
      "text": "Виктор Шеренков, Да, это использую, если обратить внимание котировки начинаются с 10-15, то есть с 15 минутной задержкой"
    },
    {
      "id": 17417440,
      "author": "drmfd",
      "datetime": "2024-10-21T08:46:00.000Z",
      "text": "А на маке значо знаете как такое реализовывать?"
    },
    {
      "id": 17417451,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T08:51:00.000Z",
      "text": "drmfd, на маке же эксель по-другому работает.Проблема в том что функции FILTERXML и WEBSERVICE доступны только в Excel для Windows и не поддерживаются в Excel для Mac.Можно попробовать использовать внешние инструменты например, Python или VBA. Но это надо целый скрипт писать, который будет делать всё тоже самое но по другому."
    },
    {
      "id": 17417582,
      "author": "drmfd",
      "datetime": "2024-10-21T09:36:00.000Z",
      "text": "Михаил Шардин, VBA на маке тоже нет наверное"
    },
    {
      "id": 17417498,
      "author": "Ramha",
      "datetime": "2024-10-21T09:11:00.000Z",
      "text": "Погоду можно добавить в таблицыopenweathermap.org/apiopenweathermap.org/"
    },
    {
      "id": 17417834,
      "author": "Александр Мерков",
      "datetime": "2024-10-21T10:44:00.000Z",
      "text": "А зачем котировки в Excel с сайта — вручную и отдельно каждую? В Quik есть функция вывода котировок в Excel. Можно едино-моментно, можно и транслировать."
    },
    {
      "id": 17417937,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T11:03:00.000Z",
      "text": "Александр Мерков, это если есть квик. А зачем он?"
    },
    {
      "id": 17418038,
      "author": "wrmngr",
      "datetime": "2024-10-21T11:28:00.000Z",
      "text": "аж цельный доклад на конференции? это же уровень лабораторной работы студента 2 курса технического вуза"
    },
    {
      "id": 17418051,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T11:31:00.000Z",
      "text": "wrmngr, а вы с какой темой докладываете?"
    },
    {
      "id": 17418061,
      "author": "Воронов Дмитрий",
      "datetime": "2024-10-21T11:33:00.000Z",
      "text": "Михаил, у меня не обновляются данные в файле. В чем может быть причина?"
    },
    {
      "id": 17418077,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T11:35:00.000Z",
      "text": "Воронов Дмитрий, в каком именно файле? В статье их два"
    },
    {
      "id": 17418114,
      "author": "Воронов Дмитрий",
      "datetime": "2024-10-21T11:42:00.000Z",
      "text": "Михаил Шардин,"
    },
    {
      "id": 17418140,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T11:47:00.000Z",
      "text": "Воронов Дмитрий, включите содержимое и чтобы обновить все ячейки нажмите CTRL+ALT+F9 это пересчет всех листов всех открытых книг.А что в ещё одном LKOH нет значений — ошибка где-то у Вас в формуле."
    },
    {
      "id": 17418308,
      "author": "Воронов Дмитрий",
      "datetime": "2024-10-21T12:26:00.000Z",
      "text": "Михаил Шардин, после обновления во всех ячейках появились#ЗНАЧ!, даже в тех, где была Ваша формула."
    },
    {
      "id": 17418337,
      "author": "Михаил Шардин",
      "datetime": "2024-10-21T12:33:00.000Z",
      "text": "Воронов Дмитрий, я только что всё проверил — у меня работает.Вы в России находитесь сейчас?Если нет, то надо использовать VPN. А если да, то надо его выключить."
    },
    {
      "id": 17418384,
      "author": "Воронов Дмитрий",
      "datetime": "2024-10-21T12:40:00.000Z",
      "text": "Михаил Шардин, я в РФ, работаю без VPN. Вечером перепроверю из дома."
    },
    {
      "id": 17424975,
      "author": "Воронов Дмитрий",
      "datetime": "2024-10-23T05:21:00.000Z",
      "text": "Михаил Шардин, дома файл заработал. Спасибо огромное.Подскажите, пожалуйста, а как перенести эту формулу в другой файл? Я так понимаю, что простого копирования формулы недостаточно."
    },
    {
      "id": 17425001,
      "author": "Михаил Шардин",
      "datetime": "2024-10-23T06:21:00.000Z",
      "text": "Воронов Дмитрий, почему? У этих формул нет никакой защиты"
    },
    {
      "id": 17425002,
      "author": "Михаил Шардин",
      "datetime": "2024-10-23T06:21:00.000Z",
      "text": "Воронов Дмитрий, должно простым копированием всё работать"
    },
    {
      "id": 17425030,
      "author": "Воронов Дмитрий",
      "datetime": "2024-10-23T07:14:00.000Z",
      "text": "Михаил Шардин, скопировал в другую книгу – выдаёт ошибку. Может быть надо код из модулей переносить?"
    },
    {
      "id": 17425121,
      "author": "Михаил Шардин",
      "datetime": "2024-10-23T08:24:00.000Z",
      "text": "Воронов Дмитрий, а что именно копируете? АПИ Мосбиржи и ЦБ там формулы, а остальное через VBA"
    },
    {
      "id": 17425298,
      "author": "Воронов Дмитрий",
      "datetime": "2024-10-23T09:22:00.000Z",
      "text": "Михаил Шардин, я скопировал только формулу из ячейки – не работает. Надо скопировать в книгу также и код VBA?"
    },
    {
      "id": 17426137,
      "author": "Михаил Шардин",
      "datetime": "2024-10-23T11:55:00.000Z",
      "text": "Воронов Дмитрий, да"
    },
    {
      "id": 17420352,
      "author": "Божественный",
      "datetime": "2024-10-21T22:36:00.000Z",
      "text": "На либроофисе работает тоже. Спасибо, дополню формулами свою эксельку. Я её виду паралельно с сноуболом с первого дня инвестирования."
    },
    {
      "id": 18078410,
      "author": "OnlyHuman",
      "datetime": "2025-04-06T22:21:00.000Z",
      "text": "А можно попросить открыть доступ файлу наdrive.google.com/,или выложить его в другое место? Сейчас пишет Нет доступа"
    },
    {
      "id": 18136594,
      "author": "Бомж-спекуль",
      "datetime": "2025-04-22T13:53:00.000Z",
      "text": "Присоединюсь к оратору выше, хотела скачать файл, и уже ничего нету :("
    },
    {
      "id": 18136613,
      "author": "Михаил Шардин",
      "datetime": "2025-04-22T13:56:00.000Z",
      "text": "Отправьте запрос, там автоответ придёт"
    }
  ]
}